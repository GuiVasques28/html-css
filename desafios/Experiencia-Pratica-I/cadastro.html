<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cadastro de Voluntário — Facilita ONGs</title>
  <meta name="description" content="Formulário de cadastro para voluntários e apoiadores.">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
  <a class="skip-link" href="#form-cadastro">Ir para o formulário</a>

  <header>
    <div class="header-inner">
      <a href="index.html" class="logo" aria-label="Página inicial Facilita ONGs">
        <img src="images/logo.png" alt="Logo Facilita ONGs" width="150" height="50">
      </a>
      <nav aria-label="Navegação principal">
        <ul>
          <li><a href="index.html">Início</a></li>
          <li><a href="projetos.html">Projetos</a></li>
          <li><a href="cadastro.html" aria-current="page">Cadastro</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <header class="page-header">
      <h1>Cadastro</h1>
      <p>Preencha seus dados para participar como voluntário ou apoiador.</p>
    </header>

    <section aria-labelledby="formulario">
      <h2 id="formulario">Formulário de Cadastro</h2>

      <form id="form-cadastro" action="#" method="post" novalidate>
        <!-- Dados Pessoais -->
        <fieldset>
          <legend>Dados Pessoais</legend>

          <label for="nome">Nome Completo <span aria-hidden="true">*</span></label>
          <input id="nome" name="nome" type="text" required minlength="3" placeholder="Nome completo" autocomplete="name">

          <label for="cpf">CPF <span aria-hidden="true">*</span></label>
          <input id="cpf" name="cpf" type="text" required inputmode="numeric" maxlength="14"
                 placeholder="000.000.000-00"
                 pattern="^\d{3}\.?\d{3}\.?\d{3}-?\d{2}$"
                 aria-describedby="cpf-help">
          <small id="cpf-help">Formato: 000.000.000-00</small>

          <label for="nascimento">Data de Nascimento</label>
          <input id="nascimento" name="nascimento" type="date" max="" aria-describedby="idade-help">
          <small id="idade-help">Informe sua data de nascimento.</small>
        </fieldset>

        <!-- Contato -->
        <fieldset>
          <legend>Contato</legend>

          <label for="email">E-mail <span aria-hidden="true">*</span></label>
          <input id="email" name="email" type="email" required placeholder="seu@email.com">

          <label for="telefone">Telefone <span aria-hidden="true">*</span></label>
          <input id="telefone" name="telefone" type="tel" inputmode="tel" required maxlength="15"
                 placeholder="(11) 9xxxx-xxxx"
                 pattern="^\(?\d{2}\)?\s?\d{4,5}-?\d{4}$"
                 aria-describedby="tel-help">
          <small id="tel-help">Formato: (11) 91234-5678</small>
        </fieldset>

        <!-- Endereço -->
        <fieldset>
          <legend>Endereço</legend>

          <label for="cep">CEP <span aria-hidden="true">*</span></label>
          <input id="cep" name="cep" type="text" inputmode="numeric" required maxlength="9"
                 placeholder="00000-000"
                 pattern="^\d{5}-?\d{3}$"
                 aria-describedby="cep-help">
          <small id="cep-help">Formato: 00000-000</small>

          <label for="logradouro">Endereço (Rua, Av)</label>
          <input id="logradouro" name="logradouro" type="text" placeholder="Rua Exemplo">

          <label for="numero">Número</label>
          <input id="numero" name="numero" type="text" inputmode="numeric" placeholder="123">

          <label for="complemento">Complemento</label>
          <input id="complemento" name="complemento" type="text" placeholder="Apto, bloco">

          <label for="cidade">Cidade</label>
          <input id="cidade" name="cidade" type="text" placeholder="Cidade">

          <label for="estado">Estado</label>
          <select id="estado" name="estado" required>
            <option value="">Selecione</option>
            <option value="SP">SP</option>
            <option value="RJ">RJ</option>
            <option value="MG">MG</option>
            <option value="BA">BA</option>
          </select>
        </fieldset>

        <!-- Consentimento -->
        <fieldset>
          <legend>Consentimento</legend>
          <label>
            <input type="checkbox" id="termos" name="termos" required>
            Declaro que li e concordo com a política de privacidade e uso dos meus dados.
          </label>
        </fieldset>

        <button type="submit">Enviar cadastro</button>
      </form>
    </section>
  </main>

  <footer>
    <p>&copy; <span id="ano3"></span> Facilita ONGs</p>
    <script>document.getElementById('ano3').textContent = new Date().getFullYear();</script>
  </footer>

  <!-- Importa as máscaras -->
  <script src="js/masks.js" defer></script>

  <script>
    // Validação simples + data máxima + integração ViaCEP
    (function(){
      const nascimento = document.getElementById('nascimento');
      if(nascimento){
        nascimento.max = new Date().toISOString().split('T')[0];
      }

      const form = document.getElementById('form-cadastro');
      form.addEventListener('submit', function(ev){
        if(!form.checkValidity()){
          ev.preventDefault();
        } else {
          ev.preventDefault();
          alert('Formulário válido — envio simulado.');
        }
      });

      // ===== Integração ViaCEP =====
      const cepInput = document.getElementById('cep');
      if (cepInput) {
        cepInput.addEventListener('blur', async function(){
          const cep = cepInput.value.replace(/\D/g, '');
          if (cep.length !== 8) return;

          try {
            const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
            if (!response.ok) throw new Error('Erro ao buscar CEP');

            const data = await response.json();
            if (data.erro) throw new Error('CEP não encontrado');

            // Preenche os campos se existirem
            if (data.logradouro) document.getElementById('logradouro').value = data.logradouro;
            if (data.localidade) document.getElementById('cidade').value = data.localidade;
            if (data.uf) document.getElementById('estado').value = data.uf;

          } catch (err) {
            console.warn('Erro ao buscar CEP:', err.message);
          }
        });
      }
    })();
  </script>
</body>
</html>
